<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generating a Tessellation from Statistical Cell Properties &mdash; Neper 4.3.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Meshing a Polycrystal Image Obtained by Synchrotron X-Ray Diffraction" href="morpho_tesr_mesh.html" />
    <link rel="prev" title="Generating and Meshing a Simple Tessellation" href="simple_model.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Neper
          </a>
              <div class="version">
                4.3.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/index.html">Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="simple_model.html">Generating and Meshing a Simple Tessellation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Generating a Tessellation from Statistical Cell Properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-the-built-in-graingrowth">Using the Built-in <code class="xref py py-data docutils literal notranslate"><span class="pre">graingrowth</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#specifying-custom-properties">Specifying Custom Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="#specifying-an-absolute-cell-size-distribution">Specifying an Absolute Cell Size Distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#specifying-an-experimental-cell-size-distribution">Specifying an Experimental Cell Size Distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#speeding-up-tessellation">Speeding up Tessellation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="morpho_tesr_mesh.html">Meshing a Polycrystal Image Obtained by Synchrotron X-Ray Diffraction</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../papers.html">Reference Papers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../talks.html">Talks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../downloads.html">Downloads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../others.html">Other Resources</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Neper</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../tutorials.html">Tutorials</a> &raquo;</li>
      <li>Generating a Tessellation from Statistical Cell Properties</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/morpho_statistics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="generating-a-tessellation-from-statistical-cell-properties">
<span id="morpho-statistics"></span><h1>Generating a Tessellation from Statistical Cell Properties<a class="headerlink" href="#generating-a-tessellation-from-statistical-cell-properties" title="Permalink to this headline"></a></h1>
<p>Statistical morphological properties for the cells can be specified as input, using option <a class="reference internal" href="../doc/neper_t.html#cmdoption-morpho"><code class="xref std std-option docutils literal notranslate"><span class="pre">-morpho</span></code></a>.  In this case, instead of a Voronoi tessellation, Neper generates a Laguerre tessellation (which can represent any tessellation comprised of convex cells, and therefore does not involve particular limitations) by optimizing the attributes of its seeds until the specified input is reached <a class="reference internal" href="morpho_tesr_mesh.html#cmame2018" id="id1"><span>[CMAME2018]</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To reproduce <em>exactly</em> the images below, add the following line to your <code class="file docutils literal notranslate"><span class="pre">$HOME/.neperrc</span></code> file (or to a local configuration file to be loaded with <code class="xref std std-option docutils literal notranslate"><span class="pre">--rcfile</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">neper</span> <span class="o">-</span><span class="n">V</span> <span class="o">-</span><span class="n">imagesize</span> <span class="mi">800</span><span class="p">:</span><span class="mi">400</span>
</pre></div>
</div>
</div>
<div class="section" id="using-the-built-in-graingrowth">
<h2>Using the Built-in <code class="xref py py-data docutils literal notranslate"><span class="pre">graingrowth</span></code><a class="headerlink" href="#using-the-built-in-graingrowth" title="Permalink to this headline"></a></h2>
<p>Option <a class="reference internal" href="../doc/neper_t.html#cmdoption-morpho"><code class="xref std std-option docutils literal notranslate"><span class="pre">-morpho</span></code></a> includes the <code class="xref py py-data docutils literal notranslate"><span class="pre">graingrowth</span></code> (or <code class="xref py py-data docutils literal notranslate"><span class="pre">gg</span></code>, for short) properties, which corresponds to those of an experimental polycrystal subjected to grain growth.  Both the cell size distribution and the cell sphericity distribution (how close are the cells from a sphere) are defined <a class="reference internal" href="morpho_tesr_mesh.html#cmame2018" id="id2"><span>[CMAME2018]</span></a>.</p>
<p>A 100-cell tessellation with grain-growth properties can be generated using the <a class="reference internal" href="../doc/neper_t.html#neper-t"><span class="std std-ref">Tessellation Module (-T)</span></a> as follows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>neper -T -n <span class="m">100</span> -morpho gg
</pre></div>
</div>
<p>This produces a <a class="reference internal" href="../doc/fileformat.html#tess-file"><span class="std std-ref">Tessellation File (.tess)</span></a> named <code class="file docutils literal notranslate"><span class="pre">n100-id1.tess</span></code>.</p>
<p>The tessellation can be visualized using the <a class="reference internal" href="../doc/neper_v.html#neper-v"><span class="std std-ref">Visualization Module (-V)</span></a>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>neper -V n100-id1.tess -print img1
</pre></div>
</div>
<p>This produces a PNG file named <code class="file docutils literal notranslate"><span class="pre">img1.png</span></code>.</p>
<img alt="../_images/img1.png" src="../_images/img1.png" />
</div>
<div class="section" id="specifying-custom-properties">
<h2>Specifying Custom Properties<a class="headerlink" href="#specifying-custom-properties" title="Permalink to this headline"></a></h2>
<p>Statistical properties other than those of <code class="xref py py-data docutils literal notranslate"><span class="pre">gg</span></code> can be specified.  <code class="xref py py-data docutils literal notranslate"><span class="pre">gg</span></code> actually is an alias for <code class="xref py py-data docutils literal notranslate"><span class="pre">diameq:lognormal(1,0.35),1-sphericity:lognormal(0.145,0.03)</span></code>, where <code class="xref py py-data docutils literal notranslate"><span class="pre">diameq::lognormal(1,0.35)</span></code> specifies a lognormal distribution of the (normalized) cell equivalent diameters of average 1 and standard deviation 0.35, and <code class="xref py py-data docutils literal notranslate"><span class="pre">1-sphericity:lognormal(0.145,0.03)</span></code> corresponds to a lognormal distribution of the cell “1-sphericities” of average 0.145 and standard deviation 0.03. It is therefore possible to use this longer argument and change the numerical values.  For example, to get nearly equal-size cells (small standard deviation of the cell size lognormal distribution), one may use:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>neper -T -n <span class="m">100</span> -morpho <span class="s2">&quot;diameq:lognormal(1,0.05),1-sphericity:lognormal(0.145,0.03)&quot;</span>
</pre></div>
</div>
<p>The tessellation can be visualized as before:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>neper -V n100-id1.tess -print img2
</pre></div>
</div>
<img alt="../_images/img2.png" src="../_images/img2.png" />
<p>Of course, it is also possible to change the sphericity distribution, for instance to get less spherical grains (smaller average of the sphericity distribution):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>neper -T -n <span class="m">100</span> -morpho <span class="s2">&quot;diameq:lognormal(1,0.05),1-sphericity:lognormal(0.245,0.03)&quot;</span>
</pre></div>
</div>
<p>The tessellation can be visualized as before:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>neper -V n100-id1.tess -print img3
</pre></div>
</div>
<img alt="../_images/img3.png" src="../_images/img3.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference internal" href="../doc/exprskeys.html#statistical-distributions"><span class="std std-ref">Statistical Distributions</span></a> for a list of possible distributions and other possible inputs.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Although it is not strictly needed, distributions for both the sizes (e.g. <code class="xref py py-data docutils literal notranslate"><span class="pre">diameq</span></code>) and the shapes of the cells should be specified.  Generating a tessellation from only a cell size distribution can lead to unrealistically small cell sphericities.</p>
</div>
</div>
<div class="section" id="specifying-an-absolute-cell-size-distribution">
<h2>Specifying an Absolute Cell Size Distribution<a class="headerlink" href="#specifying-an-absolute-cell-size-distribution" title="Permalink to this headline"></a></h2>
<p>It is possible to get Neper to consider the cell size distribution as a distribution of absolute values by using <a class="reference internal" href="../doc/neper_t.html#cmdoption-n"><code class="xref std std-option docutils literal notranslate"><span class="pre">-n</span></code></a> <code class="xref py py-data docutils literal notranslate"><span class="pre">from_morpho</span></code> (instead of an actual number of cells).  Neper determines the number of cells from the cell size distribution and the domain size.  An example is:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>neper -T -n from_morpho -morpho <span class="s2">&quot;diameq:lognormal(0.2,0.06),1-sphericity:lognormal(0.145,0.03)&quot;</span> -o mytess
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Option <a class="reference internal" href="../doc/neper_t.html#cmdoption-o"><code class="xref std std-option docutils literal notranslate"><span class="pre">-o</span></code></a> is used to set the output file name.  The default file name is <code class="file docutils literal notranslate"><span class="pre">n&lt;n&gt;-id&lt;id&gt;.tess</span></code> and, in this case, would be the odd <code class="file docutils literal notranslate"><span class="pre">nfrom_morpho-id1.tess</span></code>.</p>
</div>
<p>The tessellation contains 184 cells and can be visualized as before:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>neper -V mytess.tess -print img4
</pre></div>
</div>
<img alt="../_images/img4.png" src="../_images/img4.png" />
</div>
<div class="section" id="specifying-an-experimental-cell-size-distribution">
<h2>Specifying an Experimental Cell Size Distribution<a class="headerlink" href="#specifying-an-experimental-cell-size-distribution" title="Permalink to this headline"></a></h2>
<p>Experimental or, more generally, numerical distributions defined from a file can be specified by using option <a class="reference internal" href="../doc/neper_t.html#cmdoption-morpho"><code class="xref std std-option docutils literal notranslate"><span class="pre">-morpho</span></code></a> <code class="xref py py-data docutils literal notranslate"><span class="pre">&lt;property&gt;:custom(&lt;file_name&gt;)</span></code> (instead of analytical distributions).</p>
<p>Consider a cell-size (<code class="xref py py-data docutils literal notranslate"><span class="pre">diameq</span></code>) distribution defined from a file, <code class="file docutils literal notranslate"><span class="pre">mydistrib</span></code>, that contains:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.2</span> <span class="mf">10.0</span>
<span class="mf">0.3</span> <span class="mf">20.0</span>
<span class="mf">0.4</span>  <span class="mf">5.0</span>
</pre></div>
</div>
<p>i.e., 10 cells have a <code class="xref py py-data docutils literal notranslate"><span class="pre">diameq</span></code> equal to 0.2, 20 cells have a <code class="xref py py-data docutils literal notranslate"><span class="pre">diameq</span></code> equal to 0.3, and 5 cells have a <code class="xref py py-data docutils literal notranslate"><span class="pre">diameq</span></code> equal to 0.4 (for a tessellation comprising 35 cells).  The numbers on the right column are actually only considered relative to each other.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>In contrast to analytical distributions, numerical distributions do not need to be normalized to 1.</p></li>
<li><p>As for an analytical distribution, if <a class="reference internal" href="../doc/neper_t.html#cmdoption-morpho"><code class="xref std std-option docutils literal notranslate"><span class="pre">-morpho</span></code></a> <code class="xref py py-data docutils literal notranslate"><span class="pre">from_morpho</span></code> is used, Neper determines the number of cells from the cell size distribution and the domain size.</p></li>
</ul>
</div>
<p>The corresponding tessellation can be generated as follows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>neper -T -n from_morpho                                                        <span class="se">\</span>
           -morpho <span class="s2">&quot;diameq:custom(mydistrib),1-sphericity:lognormal(0.145,0.03)&quot;</span> <span class="se">\</span>
           -statcell diameq                                                      <span class="se">\</span>
           -o mytess
</pre></div>
</div>
<p>where option <a class="reference internal" href="../doc/neper_t.html#cmdoption-statcell"><code class="xref std std-option docutils literal notranslate"><span class="pre">-statcell</span></code></a> is used to output the cell equivalent diameters to file <code class="file docutils literal notranslate"><span class="pre">mytess.stcell</span></code>.</p>
<p>The tessellation can be visualized by coloring the cells from their equivalent diameters using options <code class="xref std std-option docutils literal notranslate"><span class="pre">-datacellcol</span></code> and <code class="xref std std-option docutils literal notranslate"><span class="pre">-datacellscale</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>neper -V mytess.tess                                       <span class="se">\</span>
           -datacellcol <span class="s2">&quot;real:file(mytess.stcell)&quot;</span>           <span class="se">\</span>
           -datacellscale <span class="m">0</span>.15:0.20:0.25:0.30:0.35:0.40:0.45 <span class="se">\</span>
           -datacellscaletitle <span class="s2">&quot;Cell size (mm)&quot;</span>              <span class="se">\</span>
           -print img5
</pre></div>
</div>
<p>This produces a PNG file named <code class="file docutils literal notranslate"><span class="pre">img5.png</span></code> for the tessellation and a PNG file named <code class="file docutils literal notranslate"><span class="pre">img5-scale3.png</span></code> for the scale bar.</p>
<p>To include the scale bar to the image, ImageMagick can be used:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>convert img5.png img5-scale3.png -gravity East -composite img5.png
</pre></div>
</div>
<img alt="../_images/img5.png" src="../_images/img5.png" />
</div>
<div class="section" id="speeding-up-tessellation">
<h2>Speeding up Tessellation<a class="headerlink" href="#speeding-up-tessellation" title="Permalink to this headline"></a></h2>
<p>When statistical properties (or other properties) are specified as input, Neper employs an interative approach, and so tessellation generation is longer than for a standard Voronoi tessellation. Even though the tessellation generation remains relatively fast, to speed up the tessellation process, a first way is through multithreading, as a performace increase is expected up about 16 threads.  A second way is to modify the termination criterion, which is controlled by option <a class="reference internal" href="../doc/neper_t.html#cmdoption-morphooptistop"><code class="xref std std-option docutils literal notranslate"><span class="pre">-morphooptistop</span></code></a> and set to <code class="xref py py-data docutils literal notranslate"><span class="pre">val=1e-5</span></code> by default, which is relatively low.  The value can be increased, or another criterion can be used.</p>
<dl class="citation">
<dt class="label" id="cmame2018"><span class="brackets">CMAME2018</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>)</span></dt>
<dd><p><a class="reference internal" href="../papers.html#singlescale"><span class="std std-ref">R Quey and L Renversade, Optimal polyhedral description of 3D polycrystals: method and application to statistical and synchrotron X-ray diffraction data, Computer Methods in Applied Mechanics and Engineering, vol. 330, pp. 308-333, 2018.</span></a></p>
</dd>
</dl>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="simple_model.html" class="btn btn-neutral float-left" title="Generating and Meshing a Simple Tessellation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="morpho_tesr_mesh.html" class="btn btn-neutral float-right" title="Meshing a Polycrystal Image Obtained by Synchrotron X-Ray Diffraction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Romain Quey.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>